---
// No imports ni l칩gica extra - solo en espa침ol

// Datos de las rese침as
const reviews = [
  {
    id: 1,
    iframeSrc: "https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Fmary.daboin.romero%2Fposts%2Fpfbid02sMyKmK7dKadMtpGH3eKdadTf54wK75BdJ2npvqqqbucUg5DKS7xndY8aeiUpcMRXl&show_text=true&width=500"
  },
  {
    id: 2,
    iframeSrc: "https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Fluduena.jugi%2Fposts%2Fpfbid02g3wth84YSmHXHm9xDxnbqQuytSciXoCfVVZb6CCiSatQjy3tXjEJCQWPBXjNBCBbl&show_text=true&width=500"
  },
  {
    id: 3,
    iframeSrc: "https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Fadrian.quesada.3597%2Fposts%2Fpfbid0rKMwDHmyMDEuf198mCe2nfd8q1yA3y5EZsgAjBxvX5gMcNsc68KiSt2rMc73bnXql&show_text=true&width=500"
  }
];

const itemsPerSlide = 3;
const opinionGroups = reviews.reduce((acc, _, index) => 
  index % itemsPerSlide === 0 ? [...acc, reviews.slice(index, index + itemsPerSlide)] : acc, 
[]);
---

<section id="reviews-section" class="opinionesSection" data-aos="fade-up">
  <h2 data-aos="fade-up" data-aos-delay="100">Our customers' opinions</h2>
  {opinionGroups.length > 0 ? (
    <div class="carouselContainer" data-aos="fade-up" data-aos-delay="200">
      <div class="opinionesGrid" data-aos="fade-up" data-aos-delay="300">
        {opinionGroups[0].map((rev, index) => (
          <div class="fadeIn" data-id={rev.id} data-aos="fade-up" data-aos-delay={400 + index * 100}>
            <div class="facebook-iframe-card" style="cursor: pointer; width: 100%; max-width: 500px;">
              <iframe
                src={rev.iframeSrc}
                width="100%"
                height="250"
                style="border: none; overflow: hidden;"
                scrolling="no"
                frameborder="0"
                allowfullscreen
                allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"
              ></iframe>
            </div>
          </div>
        ))}
      </div>

      {opinionGroups.length > 1 && (
        <>
          <button class="carouselControlPrev" id="prevButton" data-aos="fade-right" data-aos-delay="500">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
              <path d="M16.293 9.293L12 13.586 7.707 9.293l-1.414 1.414L12 16.414l5.707-5.707z"/>
            </svg>
          </button>
          <button class="carouselControlNext" id="nextButton" data-aos="fade-left" data-aos-delay="500">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7.707 14.707L12 10.414l4.293 4.293 1.414-1.414L12 7.586 6.293 13.293z"/>
            </svg>
          </button>
        </>
      )}
    </div>
  ) : (
    <p class="text-center" data-aos="fade-up" data-aos-delay="200">No hay rese침as disponibles</p>
  )}
</section>

<script define:vars={{ opinionGroups }}>
  let currentSlide = 0;
  const prevButton = document.getElementById('prevButton');
  const nextButton = document.getElementById('nextButton');
  const opinionesGrid = document.querySelector('.opinionesGrid');

  const updateSlide = (newSlide) => {
    currentSlide = newSlide;
    if (opinionesGrid) {
      opinionesGrid.innerHTML = opinionGroups[currentSlide].map(rev => `
        <div class="fadeIn" data-id="${rev.id}">
          <div class="facebook-iframe-card" style="cursor: pointer; width: 100%; max-width: 500px;">
            <iframe
              src="${rev.iframeSrc}"
              width="100%"
              height="250"
              style="border: none; overflow: hidden;"
              scrolling="no"
              frameborder="0"
              allowfullscreen
              allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"
            ></iframe>
          </div>
        </div>
      `).join('');
    }
  };

  prevButton?.addEventListener('click', () => {
    const newSlide = (currentSlide - 1 + opinionGroups.length) % opinionGroups.length;
    updateSlide(newSlide);
  });

  nextButton?.addEventListener('click', () => {
    const newSlide = (currentSlide + 1) % opinionGroups.length;
    updateSlide(newSlide);
  });
</script>

<style>
.opinionesSection {
  background: #f8f9fa;
  padding: 3rem 0 2rem 0;
  text-align: center;
}

.opinionesSection h2 {
  color: #8bbaca;
  font-size: 2.2rem;
  font-weight: 700;
  margin-bottom: 1.2rem;
  letter-spacing: 1px;
}

.carouselContainer {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  margin: 0 auto;
}

.opinionesGrid {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  justify-content: center;
  align-items: stretch;
  margin-bottom: 2rem;
}

.facebook-iframe-card {
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 4px 24px rgba(0,0,0,0.08), 0 1.5px 4px rgba(139,186,202,0.08);
  padding: 1.2rem 1rem 1rem 1rem;
  transition: box-shadow 0.2s, transform 0.2s;
  width: 100%;
  max-width: 400px;
  min-width: 280px;
  min-height: 270px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.facebook-iframe-card:hover {
  box-shadow: 0 8px 32px rgba(139,186,202,0.18), 0 2px 8px rgba(139,186,202,0.12);
  transform: translateY(-4px) scale(1.02);
}

.facebook-iframe-card iframe {
  border-radius: 12px;
  width: 100%;
  min-height: 250px;
  background: #f6f6f6;
}

.carouselControlPrev, .carouselControlNext {
  background: #8bbaca;
  border: none;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  margin: 0 0.5rem;
  box-shadow: 0 2px 8px rgba(139,186,202,0.12);
  cursor: pointer;
  transition: background 0.2s, transform 0.2s;
}

.carouselControlPrev:hover, .carouselControlNext:hover {
  background: #4a90e2;
  transform: scale(1.08);
}

.text-center {
  text-align: center;
}

@media (max-width: 900px) {
  .opinionesGrid {
    gap: 1.2rem;
  }
  .facebook-iframe-card {
    max-width: 95vw;
    min-width: 180px;
    padding: 0.7rem 0.3rem 0.7rem 0.3rem;
  }
}

@media (max-width: 600px) {
  .opinionesSection {
    padding: 2rem 0 1rem 0;
  }
  .opinionesSection h2 {
    font-size: 1.3rem;
    margin-bottom: 0.7rem;
  }
  .opinionesGrid {
    flex-direction: column;
    gap: 1rem;
  }
  .facebook-iframe-card {
    min-width: 0;
    max-width: 100vw;
    padding: 0.3rem 0.1rem 0.3rem 0.1rem;
  }
}
</style> 